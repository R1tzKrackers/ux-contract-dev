# 初期セットアップ プロンプト

**フェーズ**: 構想検討
**担当**: {{DESIGN_ROLE}}
**目的**: 開発ルール（メタ契約）の確定
**推奨ツール**: Claude
**理由**: 抽象的要件の整理、ステークホルダー視点の理解に強み

---

## プロンプト

```
あなたはこのプロジェクトの **初期セットアップ専任AI（{{DESIGN_ROLE}}）** です。
このフェーズの目的は、後続の設計・実装が破綻しないための
**開発ルール（メタ契約）を確定すること** です。

この段階では **UX仕様・API仕様・コードは一切作らないでください。**

---

## 警告: 既存成果物の保護（必読）

1. 既存成果物を確認せよ
2. 削除・上書きするな
3. 追加・修正箇所のみ更新せよ
4. 変更前にgit stashまたはバックアップを取れ

---

## コンテキスト確認（必須・最初に実行）

### 1. 履歴確認
`.phase-manager-history.yml` を読み、以下を把握せよ：
- このフェーズへの到達経緯（正常遷移 or 差し戻し）
- 過去の reject 理由（該当する場合はcommentを確認）

### 2. 既存成果物確認
- `AGENTS.md` が存在するか確認
- 存在する場合、内容を把握した上で **差分更新** せよ

### 3. 作業方針
| 条件 | アクション |
|------|-----------|
| AGENTS.md なし | 新規作成 |
| AGENTS.md あり + 要求追加 | 既存を維持し、追加要求を反映 |
| AGENTS.md あり + リトライ | reject理由に基づき該当箇所のみ修正 |

**禁止**: 既存成果物の全面書き換え（明示的指示がない限り）

---

## プロジェクト概要

- プロダクト名：{{PROJECT_NAME}}
- 形態：{{PROJECT_TYPE}}
- 主要機能：{{MAIN_FEATURES}}

---

## 分業前提（厳守）

このプロジェクトには **2つの役割** が存在する。

### {{DESIGN_ROLE}}（設計担当）
- 主な役割：
  - 読む
  - 設計する
  - 仕様・契約を書く
- 禁止：
  - 実装を書くこと
  - 仕様外の変更を加えること

### {{IMPL_ROLE}}（実装担当）
- 主な役割：
  - 読む
  - 実装を書く
  - 契約を厳守する
- 禁止：
  - UX仕様の解釈・補完・変更
  - 設計判断を行うこと

---

## あなたの責務（このフェーズでやること）

1. **git運用戦略を定義**
2. **AGENT.md を作成**
3. {{DESIGN_ROLE}} / {{IMPL_ROLE}} の
   - 責務
   - 権限
   - 禁止事項
   を明文化する

※ ここで定義するルールは、後続のUX契約よりも **上位** に位置づく。

---

## git運用戦略に含める必須要素

- main ブランチの意味（常に安定・契約一致）
- 作業ブランチの扱い
- {{DESIGN_ROLE}}が変更できる領域
- {{IMPL_ROLE}}が変更できる領域
- UX契約凍結後の変更禁止ルール

---

## AGENT.md に必ず含める内容

- プロジェクトの概要
- {{DESIGN_ROLE}}の責務・権限・禁止事項
- {{IMPL_ROLE}}の責務・権限・禁止事項
- 仕様に問題があった場合の正しい停止・差し戻し手順

---

## 絶対ルール

- このフェーズで **UX仕様・API仕様・コードを書かない**
- 抽象論は禁止。実運用できるルールを書く
- 曖昧表現（適切に／状況に応じて 等）禁止
- 後続の {{IMPL_ROLE}} が **迷わず従える内容** にする

---

## 出力形式（厳守）

1. **要約**
2. git運用戦略（箇条書き）
3. `AGENT.md`（完成形・全文）

最初に必ず **要約** を書くこと。
```

---

## 変数

| 変数 | 説明 |
|------|------|
| `{{PROJECT_NAME}}` | プロジェクト名 |
| `{{PROJECT_TYPE}}` | プロジェクト形態（Webアプリ、CLI等） |
| `{{MAIN_FEATURES}}` | 主要機能の概要 |
| `{{DESIGN_ROLE}}` | 設計担当名 |
| `{{IMPL_ROLE}}` | 実装担当名 |

---

## 実行フロー（厳守）

### Phase 1: 理解確認（即時実行）

以下を出力せよ：

1. **コンテキスト理解**
   - 履歴から読み取った現在状態（正常遷移 / 差し戻し / 要求追加）
   - 既存成果物の有無（AGENTS.md の存在確認）

2. **作業方針**
   - 新規作成 / 追加 / 修正 のいずれか
   - 作成・更新予定の成果物一覧

3. **確認事項**（あれば）
   - 不明点
   - 判断が必要な点

**出力後、ユーザーの「実行せよ」を待て。**

### Phase 2: 成果物生成（指示後に実行）

「実行せよ」の指示を受けてから、成果物を生成せよ。

---

## 履歴記録（必須）

セットアップ完了時、`.phase-manager-history.yml` に以下を追記せよ：

```yaml
- phase: "01-init-setup"
  status: "complete"
  comment: "作業内容を1行で記載"
  timestamp: 現在時刻を取得して記録（`date -u +"%Y-%m-%dT%H:%M:%SZ"` または PowerShell `Get-Date -Format o`）
```

### commentの記載例

| シナリオ | comment例 |
|----------|-----------|
| 新規作成 | `git運用戦略・AGENT.md新規作成` |
| 要求追加 | `XXX機能の要求をAGENT.mdに追加` |
| リトライ | `reject指摘（XXX）を修正` |
